(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{465:function(t,s,a){t.exports=a.p+"assets/img/hosting_startup.f5125629.png"},466:function(t,s){t.exports="data:image/png;base64,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"},467:function(t,s,a){t.exports=a.p+"assets/img/webapplication2.e213a50c.png"},468:function(t,s,a){t.exports=a.p+"assets/img/webapplication3.903f32ef.png"},469:function(t,s,a){t.exports=a.p+"assets/img/webapplication4.0647bf67.png"},470:function(t,s,a){t.exports=a.p+"assets/img/webapplication5.03e486d1.png"},517:function(t,s,a){"use strict";a.r(s);var n=a(2),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("p",[t._v("这是该系列的第四篇文章："),s("RouterLink",{attrs:{to:"/blogs/2022/exploring-dotnet-6/"}},[t._v("探索 .NET 6")]),t._v("。")],1),t._v(" "),s("p",[t._v("在"),s("a",{attrs:{href:"./part-3-exploring-the-code-behind-webapplicationbuilder"}},[t._v("我之前的文章中")]),t._v("，我们查看了 "),s("code",[t._v("WebApplicationBuilder")]),t._v(" 背后的代码，包括它的一些帮助器类，如 "),s("code",[t._v("ConservationHostBuilder")]),t._v(" 和 "),s("code",[t._v("BootstrapHostBuilder")]),t._v("。在文章的最后，我们创建了一个 "),s("code",[t._v("WebApplicationBuilder")]),t._v(" 的实例，并调用 "),s("code",[t._v("Build")]),t._v("() 来创建一个 "),s("code",[t._v("WebApplication")]),t._v("。在这篇文章中，我们将介绍 "),s("code",[t._v("WebApplication")]),t._v(" 背后的一些代码，并重点介绍中间件和终结点的配置方式。")]),t._v(" "),s("h2",{attrs:{id:"webapplication-简要回顾"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#webapplication-简要回顾"}},[t._v("#")]),t._v(" WebApplication：简要回顾")]),t._v(" "),s("p",[t._v("这篇文章是"),s("a",{attrs:{href:"./part-3-exploring-the-code-behind-webapplicationbuilder"}},[t._v("上一篇关于 "),s("code",[t._v("WebApplicationBuilder")]),t._v(" 的文章")]),t._v("，以及 "),s("a",{attrs:{href:"./part-2-comparing-webapplicationbuilder-to-the-generic-host"}},[s("code",[t._v("WebApplication")]),t._v(" 的介绍")]),t._v("的延续，所以我建议你从这些帖子开始，如果你还没有读过它们。也就是说，与上一篇文章相比，我不会在这篇文章中深入代码！")]),t._v(" "),s("p",[t._v("正如我在"),s("RouterLink",{attrs:{to:"/blogs/2022/exploring-dotnet-6/part-2-comparing-webapplicationbuilder-to-the-generic-host.html#webapplication-担任多项任务"}},[t._v("之前文章中")]),t._v("所描述的那样，"),s("code",[t._v("WebApplicationBuilder")]),t._v(" 是您进行大部分应用程序配置的地方，而 "),s("code",[t._v("WebApplication")]),t._v(" 用于三个不同的事情：")],1),t._v(" "),s("ul",[s("li",[t._v("这是您配置中间件管道的地方，因为它实现了 "),s("code",[t._v("IApplicationBuilder")]),t._v("。")]),t._v(" "),s("li",[t._v("这是您使用"),s("code",[t._v("MapGet()")]),t._v("，"),s("code",[t._v("MapRazorPages()")]),t._v(" 等配置终结点的地方，因为它实现了"),s("code",[t._v("IEndpointRouteBuilder")]),t._v("。")]),t._v(" "),s("li",[t._v("这是您通过调用 "),s("code",[t._v("Run")]),t._v("() 来实际启动应用程序所运行的内容，因为它实现了 "),s("code",[t._v("IHost")]),t._v("。")])]),t._v(" "),s("p",[t._v("在"),s("RouterLink",{attrs:{to:"/blogs/2022/exploring-dotnet-6/part-3-exploring-the-code-behind-webapplicationbuilder.html#使用-webapplicationbuilder-build-构建-webapplication"}},[t._v("上一篇文章的末尾")]),t._v("，我们看到当您在 "),s("code",[t._v("WebApplicationBuilder")]),t._v(" 实例上调用 "),s("code",[t._v("Build()")]),t._v(" 时，将创建通用主机 "),s("code",[t._v("Host")]),t._v(" 的私有实例，并将其传递给 "),s("code",[t._v("WebApplication")]),t._v(" 构造函数。这篇文章就是从这里开始继续，在我们开始研究中间件管道之前，先对 "),s("code",[t._v("WebApplication")]),t._v(" 有一点了解。")],1),t._v(" "),s("h2",{attrs:{id:"webapplication-围绕三种类型的相对简单的包装器。"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#webapplication-围绕三种类型的相对简单的包装器。"}},[t._v("#")]),t._v(" WebApplication：围绕三种类型的相对简单的包装器。")]),t._v(" "),s("p",[t._v("与 "),s("code",[t._v("WebApplicationBuilder")]),t._v(" 构造函数相比，"),s("code",[t._v("WebApplication")]),t._v(" 构造函数相对简单：")]),t._v(" "),s("div",{staticClass:"language-csharp line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-csharp"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("sealed")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WebApplication")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token type-list"}},[s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IHost")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IApplicationBuilder")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IEndpointRouteBuilder")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IAsyncDisposable")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("readonly")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IHost")]),t._v(" _host"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("readonly")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("EndpointDataSource"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" _dataSources "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("internal")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token return-type class-name"}},[t._v("IDictionary"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("object")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("?")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" Properties "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" ApplicationBuilder"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Properties"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("internal")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("string")])]),t._v(" GlobalEndpointRouteBuilderKey "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"__GlobalEndpointRouteBuilder"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("internal")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("WebApplication")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IHost")]),t._v(" host"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        _host "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" host"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        ApplicationBuilder "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constructor-invocation class-name"}},[t._v("ApplicationBuilder")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("host"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Services"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        Properties"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("GlobalEndpointRouteBuilderKey"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br")])]),s("p",[t._v("构造函数和字段初始值设定项主要执行 4 项操作：")]),t._v(" "),s("ul",[s("li",[t._v("在 "),s("code",[t._v("_host")]),t._v(" 字段中保存提供的 "),s("code",[t._v("Host")]),t._v("。这与 ASP.NET Core 3.x/5 中使用通用主机时所使用的 "),s("code",[t._v("Host")]),t._v(" 类型相同。")]),t._v(" "),s("li",[t._v("创建 "),s("code",[t._v("EndpointDataSource")]),t._v(' 的新列表。这些用于配置应用程序中的终结点，包括 Razor 页面、控制器、API 终结点和新的"最小" '),s("em",[t._v("APIs")]),t._v("。")]),t._v(" "),s("li",[t._v("创建 "),s("code",[t._v("ApplicationBuilder")]),t._v(" 的新实例。这用于构建中间件管道，并且基本上与自版本 1.0 以来使用的类型相同！")]),t._v(" "),s("li",[t._v("在 "),s("code",[t._v("ApplicationBuilder")]),t._v(" 上设置 "),s("code",[t._v("__GlobalEndpointRouteBuilder")]),t._v(' 属性。此属性用于"通信"到我们正在使用新 '),s("code",[t._v("WebApplication")]),t._v(" 的其他中间件，它具有一些不同的默认值，稍后您将看到。")])]),t._v(" "),s("p",[s("code",[t._v("WebApplication")]),t._v(" 主要将 "),s("code",[t._v("IHost")]),t._v("、"),s("code",[t._v("IApplicationBuilder")]),t._v(" 和 "),s("code",[t._v("IEndpointRouteBuilder")]),t._v(" 的实现委托给其私有属性，并显式实现它们。例如，对于 "),s("code",[t._v("IApplicationBuilder")]),t._v("，大部分实现都委托给在构造函数中创建的 "),s("code",[t._v("ApplicationBuilder")]),t._v("：")]),t._v(" "),s("div",{staticClass:"language-csharp line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-csharp"}},[s("code",[s("span",{pre:!0,attrs:{class:"token return-type class-name"}},[t._v("IDictionary"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("object")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("?")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" IApplicationBuilder"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Properties "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" ApplicationBuilder"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Properties"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token return-type class-name"}},[t._v("IServiceProvider")]),t._v(" IApplicationBuilder"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ApplicationServices\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("get")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" ApplicationBuilder"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ApplicationServices"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" ApplicationBuilder"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ApplicationServices "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("value")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token return-type class-name"}},[t._v("IApplicationBuilder")]),t._v(" IApplicationBuilder"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Use")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Func"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("RequestDelegate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" RequestDelegate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" middleware"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    ApplicationBuilder"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Use")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("middleware"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br")])]),s("p",[t._v("有趣的是，当您调用 "),s("code",[t._v("RunAsync()")]),t._v(" 时，它会构建中间件管道。")]),t._v(" "),s("h2",{attrs:{id:"启动-webapplication-并构建中间件管道"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#启动-webapplication-并构建中间件管道"}},[t._v("#")]),t._v(" 启动 WebApplication 并构建中间件管道")]),t._v(" "),s("p",[t._v("启动应用程序的标准方法是在 "),s("code",[t._v("WebApplication")]),t._v(" 上调用 "),s("code",[t._v("app.Run()")]),t._v("。这将调用 "),s("code",[t._v("WebApplication.RunAsync")]),t._v("，后者又调用 "),s("code",[t._v("IHost")]),t._v(" 扩展方法"),s("code",[t._v("HostingAbstractionsHostExtensions.RunAsync()")]),t._v("，该方法与 3.x/5 中与通用主机一起使用的方法相同。这反过来又调用了 "),s("code",[t._v("IHost.StartAsync")]),t._v("，它启动了"),s("a",{attrs:{href:"https://andrewlock.net/introducing-ihostlifetime-and-untangling-the-generic-host-startup-interactions/",target:"_blank",rel:"noopener noreferrer"}},[t._v("我之前写过的复杂的启动交互"),s("OutboundLink")],1),t._v("。")]),t._v(" "),s("p",[s("img",{attrs:{src:a(465),alt:"Sequence diagram for Host.StartAsync()"}})]),t._v(" "),s("p",[t._v("如上图所示，"),s("code",[t._v("Host")]),t._v(" 运行在应用程序中注册的 "),s("code",[t._v("IHostedService")]),t._v('，作为启动序列的一部分。从 ASP.NET Core 3.x 中的"伟大的重新平台化"开始，Web 服务器也作为 '),s("code",[t._v("IHostedService")]),t._v(" 运行，所以这是构建中间件管道并开始侦听的时候。")]),t._v(" "),s("p",[s("code",[t._v("GenericWebHostService")]),t._v(" 是构建中间件管道的地方，最后传递给 Kestrel 以运行您的应用程序。与通用主机相比，"),s("code",[t._v("WebApplication")]),t._v(" 在此过程中没有什么不同，因此，我们将介绍"),s("code",[t._v("WebApplication")]),t._v(" 如何设置中间件管道，而不是深入研究（广泛的！）代码。")]),t._v(" "),s("h2",{attrs:{id:"webapplication-的中间件管道"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#webapplication-的中间件管道"}},[t._v("#")]),t._v(" WebApplication 的中间件管道")]),t._v(" "),s("p",[t._v("与通用主机相比，"),s("code",[t._v("WebApplication")]),t._v(" 的一大区别是 "),s("code",[t._v("WebApplication")]),t._v(" 默认设置各种中间件。在"),s("RouterLink",{attrs:{to:"/blogs/2022/exploring-dotnet-6/part-3-exploring-the-code-behind-webapplicationbuilder.html#webapplicationbuilder-构造器"}},[t._v("上一篇文章中")]),t._v("，我展示了 "),s("code",[t._v("WebApplicationBuilder")]),t._v(" 调用"),s("code",[t._v("GenericHostBuilderExtensions.ConfigureWebHostDefaults()")]),t._v("。这也通常与通用主机一起使用，并设置了几个默认值：")],1),t._v(" "),s("ul",[s("li",[t._v("配置 Kestrel")]),t._v(" "),s("li",[t._v("添加 "),s("a",{attrs:{href:"https://docs.microsoft.com/en-us/aspnet/core/fundamentals/servers/kestrel/host-filtering?view=aspnetcore-5.0",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("HostFiltering")]),t._v(" 中间件"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("如果 "),s("code",[t._v("ASPNETCORE_FORWARDEDHEADERS_ENABLED")]),t._v(" 环境变量设置为 "),s("code",[t._v("true")]),t._v("，则添加 "),s("a",{attrs:{href:"https://devblogs.microsoft.com/dotnet/forwarded-headers-middleware-updates-in-net-core-3-0-preview-6/",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("ForwardedHeaders")]),t._v(" 中间件"),s("OutboundLink")],1),t._v("。")]),t._v(" "),s("li",[t._v("支持 IIS 集成")])]),t._v(" "),s("p",[t._v("除此之外，"),s("code",[t._v("WebApplicationBuilder")]),t._v(" 还设置了额外的中间件。这就是我在"),s("RouterLink",{attrs:{to:"/blogs/2022/exploring-dotnet-6/part-3-exploring-the-code-behind-webapplicationbuilder.html#webapplicationbuilder-构造器"}},[t._v("上一篇文章中提到的配置应用程序方法")]),t._v("的用武之地。根据您配置 "),s("code",[t._v("WebApplication")]),t._v(" 的方式，"),s("code",[t._v("ConfigureApplication")]),t._v(" 会向管道添加其他中间件。")],1),t._v(" "),s("p",[t._v("此代码有点复杂，因为它需要处理多个边缘情况。与其尝试过于详细地跟踪代码，不如看一些示例，看看生成的中间件管道是什么样子的。")]),t._v(" "),s("h3",{attrs:{id:"空管道"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#空管道"}},[t._v("#")]),t._v(" 空管道")]),t._v(" "),s("p",[t._v("我们将从最基本（且有些无意义）的应用程序开始，其中我们不会向应用程序添加任何额外的中间件或终结点：")]),t._v(" "),s("div",{staticClass:"language-csharp line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-csharp"}},[s("code",[s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WebApplicationBuilder")]),t._v(" builder "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" WebApplication"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("CreateBuilder")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("args"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WebApplication")]),t._v(" app "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" builder"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Build")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Run")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("p",[t._v("此设置是最基本的配置，并生成一个中间件管道，其中包含：")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("HostFilteringMiddleware")])]),t._v(" "),s("li",[s("code",[t._v("DeveloperExceptionPageMiddleware")])]),t._v(" "),s("li",[t._v("从 "),s("code",[t._v("WebApplication")]),t._v(" 的 "),s("code",[t._v("ApplicationBuilder")]),t._v(' 构建的"空"中间件。')])]),t._v(" "),s("p",[t._v("如下所示：")]),t._v(" "),s("p",[s("img",{attrs:{src:a(466),alt:"The WebApplication adds the DeveloperExceptionPageMiddleware by default"}})]),t._v(" "),s("p",[s("code",[t._v("HostFilteringMiddleware")]),t._v(" 是由于对 "),s("code",[t._v("ConfigureWebHostDefaults")]),t._v("() 的隐藏调用而添加的，如上一节所述。未添加 "),s("code",[t._v("ForwardedHeadersMiddleware")]),t._v("，因为未添加环境变量。")]),t._v(" "),s("p",[t._v("现在，当您在开发环境中运行时，会自动添加 "),s("code",[t._v("DeveloperExceptionPage")]),t._v("，并将以下内容添加到每个中间件管道的开头：")]),t._v(" "),s("div",{staticClass:"language-csharp line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-csharp"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("HostingEnvironment"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("IsDevelopment")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("UseDeveloperExceptionPage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("p",[t._v("管道中的最后一块中间件是使用直接添加到 "),s("code",[t._v("Program.cs")]),t._v(" 中的 "),s("code",[t._v("WebApplication")]),t._v(" 的 "),s("code",[t._v("ApplicationBuilder")]),t._v(' 的中间件构建的。在此示例中，我们没有添加任何内容，因此我们实质上是在中间件内部添加了一个"空"管道。')]),t._v(" "),s("p",[t._v("显然，仅具有默认中间件的应用程序没有多大用处，因此让我们做一些基本的并向"),s("code",[t._v("WebApplication")]),t._v(" 添加一些中间件。")]),t._v(" "),s("h3",{attrs:{id:"具有额外中间件的管道"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#具有额外中间件的管道"}},[t._v("#")]),t._v(" 具有额外中间件的管道")]),t._v(" "),s("p",[t._v("在此示例中，我们将一些其他中间件添加到管道中：静态文件中间件和 HTTPS 重定向中间件：")]),t._v(" "),s("div",{staticClass:"language-csharp line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-csharp"}},[s("code",[s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WebApplicationBuilder")]),t._v(" builder "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" WebApplication"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("CreateBuilder")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("args"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WebApplication")]),t._v(" app "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" builder"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Build")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 添加一些额外的中间件")]),t._v("\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("UseHttpsRedirection")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("UseStaticFiles")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Run")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br")])]),s("p",[t._v("通过此设置，我们仍然拥有与上一节中相同的三核中间件，但 "),s("code",[t._v("WebApplication.ApplicationBuilder")]),t._v(" 管道现在包含两个额外的中间件")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("HostFilteringMiddleware")])]),t._v(" "),s("li",[s("code",[t._v("DeveloperExceptionPageMiddleware")])]),t._v(" "),s("li",[s("code",[t._v("WebApplication.ApplicationBuilder")]),t._v(" 管道，包含\n"),s("ul",[s("li",[s("code",[t._v("HttpsRedirectionMiddleware")])]),t._v(" "),s("li",[s("code",[t._v("StaticFilesMiddleware")])])])])]),t._v(" "),s("p",[t._v("所以现在我们有一个看起来像这样的东西：")]),t._v(" "),s("p",[s("img",{attrs:{src:a(467),alt:"The WebApplication.ApplicationBuilder pipeline includes the middleware added directly to the WebApplication"}})]),t._v(" "),s("p",[t._v('我们仍然没有任何终结点，因此在下一个示例中，我们实现了一个 "Hello World！" 终结点 ：')]),t._v(" "),s("h3",{attrs:{id:"hello-world-管道"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#hello-world-管道"}},[t._v("#")]),t._v(' "Hello World" 管道')]),t._v(" "),s("p",[t._v('在下面的示例中，我们为主页添加了一个终结点，该终结点将文本 "Hello World！" 返回到我在上一个示例中显示的示例中：')]),t._v(" "),s("div",{staticClass:"language-csharp line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-csharp"}},[s("code",[s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WebApplicationBuilder")]),t._v(" builder "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" WebApplication"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("CreateBuilder")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("args"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WebApplication")]),t._v(" app "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" builder"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Build")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("UseHttpsRedirection")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("UseStaticFiles")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 添加单个终节点")]),t._v("\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("MapGet")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Hello World!"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Run")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br")])]),s("p",[t._v("使用 "),s("code",[t._v("MapGet()")]),t._v(" 添加终结点会将一个入口添加到 "),s("code",[t._v("WebApplication")]),t._v(" 的 "),s("code",[t._v("EndpointDataSource")]),t._v(" 集合中，这会导致 "),s("code",[t._v("ConfigureApplication")]),t._v(" 自动添加其他中间件：")]),t._v(" "),s("ul",[s("li",[s("p",[s("code",[t._v("HostFilteringMiddleware")])])]),t._v(" "),s("li",[s("p",[s("code",[t._v("DeveloperExceptionPageMiddleware")])])]),t._v(" "),s("li",[s("p",[s("code",[t._v("EndpointRoutingMiddleware")]),t._v(" （又名 "),s("code",[t._v("RoutingMiddleware")]),t._v("）")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("WebApplication.ApplicationBuilder")]),t._v(" 管道，包含")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("HttpsRedirectionMiddleware")])]),t._v(" "),s("li",[s("code",[t._v("StaticFilesMiddleware")])])])]),t._v(" "),s("li",[s("p",[s("code",[t._v("EndpointMiddleware")])])])]),t._v(" "),s("p",[t._v("请注意，在 "),s("em",[t._v("Program.cs")]),t._v(" 中定义的管道开始之前，"),s("code",[t._v("RoutingMiddleware")]),t._v(" 会自动添加到中间件管道中，并且 "),s("code",[t._v("EndpointMiddleware")]),t._v(" 会自动添加到管道末尾。生成的管道如下所示：")]),t._v(" "),s("p",[s("img",{attrs:{src:a(468),alt:"The WebApplication has added the the RoutingMiddleware and EndpointMiddleware to the pipeline"}})]),t._v(" "),s("p",[t._v("我发现非常有趣的是，"),s("code",[t._v("WebApplication")]),t._v(" 对用户隐藏了路由中间件。"),s("code",[t._v("RoutingMiddleware")]),t._v(" 和 "),s("code",[t._v("EndpointMiddleware")]),t._v(" 密切相关，并且它们施加了严格的排序要求（例如，"),s("code",[t._v("AuthorizationMiddleware")]),t._v(" 必须放在它们之间），这使得它们成为新手相对难以掌握的概念。使用 .NET 6 和 "),s("code",[t._v("WebApplication")]),t._v("，用户需要担心的事情更少了！")]),t._v(" "),s("blockquote",[s("p",[t._v("不过，这并不都是美好的。一些中间件通常假设它将在 "),s("code",[t._v("UseRouting()")]),t._v(" 之前被调用。例如，"),s("code",[t._v("ExceptionHandlerMiddleware")]),t._v("、"),s("code",[t._v("RewriterMiddleware")]),t._v("、"),s("code",[t._v("StatusCodePagesMiddleware")]),t._v(" "),s("a",{attrs:{href:"https://github.com/dotnet/aspnetcore/pull/35426",target:"_blank",rel:"noopener noreferrer"}},[t._v("都必须更新才能处理这种新模式"),s("OutboundLink")],1),t._v("。")])]),t._v(" "),s("p",[t._v("但是，如果您需要 "),s("code",[t._v("RoutingMiddleware")]),t._v(" 位于管道中的特定点，该怎么办？例如，也许您有中间件需要在"),s("code",[t._v("RoutingMiddleware")]),t._v(" 之前？")]),t._v(" "),s("h3",{attrs:{id:"具有-userouting-的管道"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#具有-userouting-的管道"}},[t._v("#")]),t._v(" 具有 UseRouting() 的管道")]),t._v(" "),s("p",[t._v("在下一个示例中，我们通过调用 "),s("code",[t._v("UseRouting()")]),t._v(" 将 "),s("code",[t._v("EndpointRoutingMiddleware")]),t._v(" 显式添加到 "),s("code",[t._v("WebApplication.ApplicationBuilder")]),t._v(" 管道中。这更接近于您希望在 .NET 3.x/5 应用中看到的内容，其中 "),s("code",[t._v("UseRouting()")]),t._v(" 位于管道的"),s("em",[t._v("中间")]),t._v("。")]),t._v(" "),s("div",{staticClass:"language-csharp line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-csharp"}},[s("code",[s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WebApplicationBuilder")]),t._v(" builder "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" WebApplication"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("CreateBuilder")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("args"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WebApplication")]),t._v(" app "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" builder"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Build")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("UseHttpsRedirection")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("UseStaticFiles")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// EndpointRoutingMiddleware 位于管道的中间")]),t._v("\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("UseRouting")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("MapGet")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Hello World!"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Run")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br")])]),s("p",[t._v("如您所料，生成的管道包含与以前相同的所有中间件，但排列顺序略有不同：")]),t._v(" "),s("ul",[s("li",[s("p",[s("code",[t._v("HostFilteringMiddleware")])])]),t._v(" "),s("li",[s("p",[s("code",[t._v("DeveloperExceptionPageMiddleware")])])]),t._v(" "),s("li",[s("p",[s("code",[t._v("WebApplication.ApplicationBuilder")]),t._v(" 管道，包含")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("HttpsRedirectionMiddleware")])]),t._v(" "),s("li",[s("code",[t._v("StaticFilesMiddleware")])]),t._v(" "),s("li",[s("code",[t._v("EndpointRoutingMiddleware")]),t._v(" （"),s("code",[t._v("RoutingMiddleware")]),t._v("）")])])]),t._v(" "),s("li",[s("p",[s("code",[t._v("EndpointMiddleware")])])])]),t._v(" "),s("p",[t._v("这可以被可视化成这样：")]),t._v(" "),s("p",[s("img",{attrs:{src:a(469),alt:"The middleware pipeline contains the RoutingMiddleware in the WebApplication.ApplicationBuilder"}})]),t._v(" "),s("p",[t._v('在"主"中间件管道和 '),s("code",[t._v("WebApplication.ApplicationBuilder")]),t._v(" 管道之间有"),s("a",{attrs:{href:"https://github.com/dotnet/aspnetcore/blob/fb05933145108588a38007f57d073aed50e66614/src/DefaultBuilder/src/WebApplicationBuilder.cs#L248-L263",target:"_blank",rel:"noopener noreferrer"}},[t._v("一个有趣的相互作用"),s("OutboundLink")],1),t._v("，在指定 "),s("code",[t._v("UseRouting()")]),t._v(" 时，"),s("code",[t._v("WebApplicationBuilder")]),t._v(" 必须小心地保留整体顺序。希望这不会经常被需要，但是当真的需要时，如果您愿意，您仍然应该能够使用 "),s("code",[t._v("WebApplicationBuilder")]),t._v("，而不是被迫回退到通用主机。")]),t._v(" "),s("p",[t._v("最后，让我们看一下如果添加终结点路由的另一端终结点（"),s("code",[t._v("EndpointMiddleware")]),t._v("）会发生什么情况。")]),t._v(" "),s("h3",{attrs:{id:"具有-useendpoints-的管道"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#具有-useendpoints-的管道"}},[t._v("#")]),t._v(" 具有 UseEndpoints() 的管道")]),t._v(" "),s("p",[t._v("如前所述，终结点路由适用于一对中间件，即"),s("em",[t._v("选择")]),t._v("终结点的 "),s("code",[t._v("EndpointRoutingMiddleware")]),t._v("（又名 "),s("code",[t._v("RoutingMiddleware")]),t._v("）和"),s("em",[t._v("执行")]),t._v("终结点的 "),s("code",[t._v("EndpointMiddleware")]),t._v("。"),s("code",[t._v("EndpointMiddleware")]),t._v(" 通常通过调用 "),s("code",[t._v("UseEndpoints")]),t._v(" 添加到管道中，但使用 "),s("code",[t._v("WebApplicationBuilder")]),t._v("，它会自动添加。让我们看看如果我们也显式添加它会发生什么。")]),t._v(" "),s("div",{staticClass:"language-csharp line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-csharp"}},[s("code",[s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WebApplicationBuilder")]),t._v(" builder "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" WebApplication"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("CreateBuilder")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("args"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WebApplication")]),t._v(" app "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" builder"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Build")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("UseHttpsRedirection")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("UseStaticFiles")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("UseRouting")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("MapGet")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Hello World!"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 显式添加终结点中间件，并添加一个新的终结点")]),t._v("\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("UseEndpoints")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("MapGet")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/ping"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pong"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Run")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br")])]),s("p",[t._v("使用上述配置，您最终会得到以下内容：")]),t._v(" "),s("ul",[s("li",[s("p",[s("code",[t._v("HostFilteringMiddleware")])])]),t._v(" "),s("li",[s("p",[s("code",[t._v("DeveloperExceptionPageMiddleware")])])]),t._v(" "),s("li",[s("p",[s("code",[t._v("WebApplication.ApplicationBuilder")]),t._v(" 管道，包含")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("HttpsRedirectionMiddleware")])]),t._v(" "),s("li",[s("code",[t._v("StaticFilesMiddleware")])]),t._v(" "),s("li",[s("code",[t._v("EndpointRoutingMiddleware")]),t._v(" （"),s("code",[t._v("RoutingMiddleware")]),t._v("）,和")]),t._v(" "),s("li",[s("code",[t._v("EndpointMiddleware")])])])]),t._v(" "),s("li",[s("p",[s("code",[t._v("EndpointMiddleware")])])])]),t._v(" "),s("p",[t._v("如果您仔细阅读上面的列表，您会发现终结点中间件出现了两次！这不是一个错误，"),s("a",{attrs:{href:"https://github.com/dotnet/aspnetcore/blob/fb05933145108588a38007f57d073aed50e66614/src/DefaultBuilder/src/WebApplicationBuilder.cs#L272-L276",target:"_blank",rel:"noopener noreferrer"}},[t._v("而是 "),s("code",[t._v("WebApplicationBuilder")]),t._v(" 无法判断 "),s("code",[t._v("EndpointMiddleware")]),t._v(" 是否被添加到 "),s("code",[t._v("WebApplication.ApplicationBuilder")]),t._v(" 管道中"),s("OutboundLink")],1),t._v('的结果。幸运的是，"外部"中间件是完全良性的。')]),t._v(" "),s("p",[s("img",{attrs:{src:a(470),alt:"The middleware pipeline contains two instances of the EndpointMiddleware"}})]),t._v(" "),s("p",[t._v("您可能还会注意到，我"),s("em",[t._v("直接")]),t._v("在 "),s("code",[t._v("WebApplication")]),t._v(" 上以及在 "),s("code",[t._v("UseEndpoints()")]),t._v(" 调用中注册了终结点。但是，这些终结点都已注册到 "),s("code",[t._v("WebApplication")]),t._v(" 的 "),s("code",[t._v("_dataSources")]),t._v("，"),s("a",{attrs:{href:"https://github.com/dotnet/aspnetcore/blob/fb05933145108588a38007f57d073aed50e66614/src/DefaultBuilder/src/WebApplicationBuilder.cs#L248-L263",target:"_blank",rel:"noopener noreferrer"}},[t._v("这要归功于 "),s("code",[t._v("WebApplicationBuilder")]),t._v(" 中属性的一些诡计多端的摆弄"),s("OutboundLink")],1),t._v("。最终结果是永远不会调用第二个中间件。")]),t._v(" "),s("p",[t._v("这涵盖了与在 "),s("code",[t._v("WebApplication")]),t._v(" 中构建中间件管道相关的大多数边缘情况。我认为看到这里所做的更改非常有趣，尽管正如"),s("a",{attrs:{href:"./part-2-comparing-webapplicationbuilder-to-the-generic-host"}},[t._v("我之前提到的")]),t._v("，我希望在 "),s("code",[t._v("WebApplication")]),t._v(" 中的中间件和终结点之间有更好的划分。例如，我希望它看起来更像这样：")]),t._v(" "),s("div",{staticClass:"language-csharp line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-csharp"}},[s("code",[s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WebApplicationBuilder")]),t._v(" builder "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" WebApplication"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("CreateBuilder")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("args"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WebApplication")]),t._v(" app "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" builder"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Build")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("UseHttpsRedirection")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("UseStaticFiles")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("UseRouting")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// I wish the "Endpoints" property was a thing')]),t._v("\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Endpoints"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("MapGet")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Hello World!"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Endpoints"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("MapGet")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/ping"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pong"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Run")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br")])]),s("p",[t._v("但就目前而言，不可否认的是，"),s("code",[t._v("WebApplication")]),t._v(" 和 "),s("code",[t._v("WebApplicationBuilder")]),t._v(" 提供了比它们包装的通用主机实现更简单的API。希望这样可以更容易地教给新手！")]),t._v(" "),s("h2",{attrs:{id:"总结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[t._v("#")]),t._v(" 总结")]),t._v(" "),s("p",[t._v('在这篇文章中，我们看到了新的"最小托管" '),s("code",[t._v("WebApplication")]),t._v(" 如何为您的应用程序构建中间件管道。我们首先查看了 "),s("code",[t._v("WebAppliation")]),t._v(" 的构造函数，以了解它的工作原理，然后查看了一些示例管道。对于每个管道，我都显示了您编写的代码以及生成的中间件管道。这显示了 "),s("code",[t._v("WebApplication")]),t._v(" 如何自动（有条件地）在管道的开头添加 "),s("code",[t._v("DeveloperExceptionPageMiddleware")]),t._v("，并将管道包装在路由中间件中。总体而言，这可以简化中间件排序问题，但最好了解正在发生的事情。")]),t._v(" "),s("p",[t._v("实现最小托管 API 需要对中间件进行大量更改以适应新模式。在下一篇文章中，我们将介绍 .NET Core 中必须更改的其他一些内容！")]),t._v(" "),s("br"),t._v(" "),s("br"),t._v(" "),s("br"),t._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"title"}),s("p",[t._v("作者：Gerry Ge")]),t._v(" "),s("p",[t._v("出处：翻译至 "),s("a",{attrs:{href:"https://andrewlock.net/exploring-dotnet-6-part-4-building-a-middleware-pipeline-with-webapplication/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Building a middleware pipeline with WebApplication"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("版权：本作品采用「"),s("a",{attrs:{href:"https://creativecommons.org/licenses/by-nc-sa/4.0/",target:"_blank",rel:"noopener noreferrer"}},[t._v("署名-非商业性使用-相同方式共享 4.0 国际"),s("OutboundLink")],1),t._v("」许可协议进行许可。")]),t._v(" "),s("p",[s("strong",[t._v("转载请注明出处")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);